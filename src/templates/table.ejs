<script>
    function toggleFilter() {
        const filterform = document.getElementById("filterform<%= tableid %>")
        if (filterform.hasAttribute("hidden")) {
            filterform.removeAttribute("hidden")
        }
        else{
            filterform.setAttribute("hidden", true);
        }
    }


    $("#textfil").on('change keyup paste', function () {
        filterTable();
    });
    function filterTable() {
        var input, filter, table, tr, td, i;
        input = document.getElementById("textfil<%= tableid %>")
        filter = input.value.toUpperCase();
        table = document.getElementById("<%= tableid %>");
        tr = table.getElementsByTagName("tr");

        // Loop through all table rows, and hide those who don't match the search query
        for (i = 0; i < tr.length; i++) {
            tds = tr[i].getElementsByTagName("td");
            let filters = true
            for (let td of tds) {
                if (td.innerHTML.toUpperCase().indexOf(filter) === -1) {
                    filters = false
                    break
                } 
            }
            if (filters) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }            
    }
</script>
<div class="container">
  <div style="visibility: <%= visible %>;">
        <button class="btn mr-auto filter-btn" onclick="toggleFilter()">
            סינון <i class="fas fa-filter"></i>
        </button>
        <form id="filterform<%= tableid %>" hidden>
            <label for="textfil<%= tableid %>">הכנס טקסט:</label>
            <input type="text" id="textfil" name="filtertext<%= tableid %>">
        </form>
  </div>
  <div class="responsive-table" dir="rtl">
    <table dir="rtl" class="table table-bordered table-condensed" id="<%= tableid %>">
      <thead>
        <tr>
        <% for (let elem of headers) { %>
          <th key="<%=elem[1]%>" scope="col"><%= elem[0] %></th>
        <%}%>          
        </tr>
      </thead>
      <% for (let data_item of data) { %>
      <tr key="<%=data_item.student%>">
        <% for (let elem of headers) { %>
        <td key="<%=elem[1]%>">
         <%= data_item[elem[1]] %>
        </td>
        <%}%>
      </tr>
      <%}%>
      <% if (data.length === 0) { %>
            <tr>
                <td colspan="<%=headers.length%>">אין תוצאות</td>
            </tr>
        <%}%>
    </table>
  </div>
</div>